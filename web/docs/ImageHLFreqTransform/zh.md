# Image HL Freq Transform - 高级细节迁移

**节点功能：** `Image HL Freq Transform`节点实现高级细节迁移技术，可将细节图像的高频信息迁移到生成图像上，支持遮罩控制和多种频率分离方法。

## 输入

| 参数名称 | 入端选择 | 数据类型 | 默认值 | 取值范围 | 描述 |
| -------- | -------- | -------- | ------ | -------- | ---- |
| `generate_image` | 必选 | IMAGE | - | - | 生成的基础图像 |
| `detail_image` | 必选 | IMAGE | - | - | 细节参考图像 |
| `method` | - | COMBO[STRING] | igbi | rgb, hsv, igbi | 频率分离方法 |
| `blur_radius` | - | FLOAT | 10.0 | 0.0-100.0 | 高斯模糊半径 |
| `detail_mask` | 可选 | MASK | - | - | 细节区域遮罩，控制迁移区域 |

## 输出

| 输出名称 | 数据类型 | 描述 |
|---------|----------|------|
| `image` | IMAGE | 细节迁移后的最终图像 |
| `high_freq` | IMAGE | 混合后的高频层 |
| `low_freq` | IMAGE | 生成图像的低频层 |

## 功能说明

### 迁移原理详解

#### RGB/HSV模式
- **处理流程**：
  1. 对细节图像进行频率分离获取高频层
  2. 对生成图像进行频率分离获取高低频层
  3. 通过遮罩混合高频层
  4. 重组最终图像
- **模糊半径调整**：生成图像使用1.5倍模糊半径以获得更好效果
- **特点**：传统方法，适用于一般细节迁移需求

#### IGBI模式（推荐）
- **低频层**：生成图像的高斯模糊结果
- **高频层计算流程**：
  1. **生成图像处理**：反转 → 高斯模糊 → 与模糊图像50%混合 → 再次反转
  2. **细节图像处理**：反转 → 高斯模糊 → 与模糊图像50%混合 → 再次反转
  3. **遮罩混合**：通过遮罩混合两个处理结果
- **最终合成**：65%高频 + 35%低频，然后应用色阶调整（黑点83，白点172）
- **特点**：提供最精确和自然的细节迁移效果

### 遮罩控制机制
- **有遮罩**：
  - 仅在遮罩白色区域进行细节迁移
  - 黑色区域保持生成图像原始细节
  - 支持灰度遮罩实现渐变过渡
- **无遮罩**：
  - 对整个图像进行细节迁移
  - 自动创建全白遮罩