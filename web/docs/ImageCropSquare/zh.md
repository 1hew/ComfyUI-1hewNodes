# Image Crop Square - 图像裁剪方形

**节点功能：** `Image Crop Square`节点用于根据遮罩将图像裁剪为方形，支持放大系数、填充颜色和遮罩抠图功能，常用于图像预处理和区域提取。当没有提供遮罩时，执行居中方形裁剪。

## 输入

| 参数名称 | 入端选择 | 数据类型 | 默认值 | 取值范围 | 描述 |
| -------- | -------- | -------- | ------ | -------- | ---- |
| `image` | 必选 | IMAGE | - | - | 输入的图像 |
| `mask` | 可选 | MASK | - | - | 用于确定裁剪区域的遮罩，如果未提供则执行居中方形裁剪 |
| `scale_factor` | - | FLOAT | 1.0 | 0.1-3.0 | 放大系数，控制裁剪区域的大小 |
| `apply_mask` | - | BOOLEAN | False | True/False | 是否应用遮罩进行抠图 |
| `extra_padding` | - | INT | 0 | 0-512 | 额外边距，单位像素 |
| `fill_color` | - | STRING | 1.0 | 灰度值/HEX/RGB/edge | 背景颜色，支持多种格式或使用"edge"自动获取边缘颜色 |
| `divisible_by` | - | INT | 8 | 1-1024 | 确保输出尺寸能被指定数值整除，常用于AI模型的尺寸要求 |

## 输出

| 输出名称 | 数据类型 | 描述 |
|---------|----------|------|
| `image` | IMAGE | 裁剪后的方形图像 |

## 功能说明

### 智能裁剪
- **遮罩驱动**：基于输入遮罩自动识别感兴趣区域，无遮罩时执行居中裁剪
- **方形输出**：自动计算最佳方形边界框，确保输出为正方形
- **中心对齐**：裁剪区域以遮罩中心或图像中心为基准进行对齐
- **边界处理**：智能处理超出图像边界的情况
- **尺寸约束**：支持divisible_by参数确保输出尺寸符合特定要求

### 填充选项
- **灰度值**：如"0.5"表示50%灰度
- **HEX格式**：如"#FF0000"表示红色
- **RGB格式**：如"255,0,0"表示红色
- **边缘颜色(edge)**：自动使用图像边缘的平均颜色进行填充
- **智能填充**：根据是否应用遮罩选择不同的颜色计算策略