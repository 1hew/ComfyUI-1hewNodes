# Image Crop With BBox - 图像裁剪带边界框

**节点功能：** `Image Crop With BBox`节点根据遮罩裁剪图像并返回边界框信息，支持多种宽高比、缩放系数和填充选项，常用于目标提取和后续粘贴操作。

## 输入

| 参数名称 | 入端选择 | 数据类型 | 默认值 | 取值范围 | 描述 |
| -------- | -------- | -------- | ------ | -------- | ---- |
| `image` | 必选 | IMAGE | - | - | 要裁剪的输入图像 |
| `mask` | 必选 | MASK | - | - | 用于确定裁剪区域的遮罩 |
| `aspect_ratio` | - | COMBO[STRING] | mask_ratio | mask_ratio, 1:1, 3:2, 4:3, 16:9, 21:9, 2:3, 3:4, 9:16, 9:21 | 输出宽高比选择 |
| `scale_factor` | - | FLOAT | 1.0 | 0.1-5.0 | 缩放系数，控制裁剪区域的大小 |
| `extra_padding` | - | INT | 0 | 0-512 | 额外边距，单位像素 |
| `exceed_image` | - | BOOLEAN | False | True/False | 是否允许裁剪区域超出原图边界 |
| `invert_mask` | - | BOOLEAN | False | True/False | 是否反转遮罩 |
| `fill_color` | - | STRING | 1.0 | 灰度值/HEX/RGB/edge | 背景填充颜色，支持多种格式 |
| `divisible_by` | - | INT | 8 | 1-1024 | 尺寸整除数，确保输出尺寸能被指定数字整除 |

## 输出

| 输出名称 | 数据类型 | 描述 |
|---------|----------|------|
| `cropped_image` | IMAGE | 裁剪后的图像 |
| `cropped_mask` | MASK | 裁剪后的遮罩 |
| `bbox_meta` | DICT | 边界框元数据，包含位置和尺寸信息 |

## 功能说明

### 宽高比控制
- **多种比例**：支持常见的宽高比选择（1:1、16:9、4:3等）
- **原始比例**：mask_ratio 保持遮罩的原始宽高比
- **自动调整**：根据选择的比例自动调整裁剪区域
- **中心保持**：调整过程中保持遮罩中心位置不变

### 缩放与填充
- **缩放控制**：通过 scale_factor 控制裁剪区域的大小
- **边距设置**：extra_padding 为裁剪区域添加额外边距
- **超界处理**：exceed_image 允许裁剪区域超出原图边界
- **智能填充**：支持多种填充颜色格式和边缘颜色自动获取

### 填充颜色格式
- **灰度值**：如"0.5"表示50%灰度
- **HEX格式**：如"#FF0000"表示红色
- **RGB格式**：如"255,0,0"表示红色
- **边缘颜色(edge)**：自动使用图像边缘的平均颜色进行填充