# Match Brightness Contrast - 亮度对比度匹配

**节点功能：** `Match Brightness Contrast` 节点用于调整源图像的亮度和对比度，使其与参考图像相匹配。该节点支持仅使用边缘区域进行统计计算，从而忽略中心内容的变化，非常适用于无缝图像融合或风格迁移任务。

## 输入

| 参数名称 | 入端选择 | 数据类型 | 默认值 | 取值范围 | 描述 |
| -------- | -------- | -------- | ------ | -------- | ---- |
| `source_image` | 必选 | IMAGE | - | - | 需要进行调整的源图像批次。 |
| `reference_image` | 必选 | IMAGE | - | - | 用作亮度对比度目标的参考图像批次。 |
| `edge_amount` | - | FLOAT | 0.2 | 0.0 - 8192.0 | 控制统计计算的边缘范围。<= 0: 使用全图；0 < amount < 1.0: 短边百分比；>= 1.0: 像素值。 |

## 输出

| 输出名称 | 数据类型 | 描述 |
|---------|----------|------|
| `image` | IMAGE | 调整后的图像批次，其亮度和对比度已与参考图像匹配。 |

## 功能说明

- **亮度对比度匹配**：自动调整源图像的均值（亮度）和标准差（对比度），使其与参考图像保持一致。
- **基于边缘的统计**：`edge_amount` 参数允许用户指定是使用整张图像还是仅使用边缘区域来计算颜色统计信息。当中心内容差异较大但背景/光照需要匹配时，此功能特别有用。
- **灵活的边缘控制**：支持基于百分比（相对于最短边）和绝对像素值的边缘定义。
- **批处理支持**：支持源图像和参考图像的批处理。如果批次大小不一致，参考图像将循环使用。

## 使用建议

- **无缝融合**：将物体合成到新背景中时，使用背景作为 `reference_image`，物体作为 `source_image`。将 `edge_amount` 设置为 0（全图）或较小值可以帮助对齐它们的光照条件。
- **风格迁移**：使用具有特定氛围或光照风格的参考图像，将其全局亮度及对比度特征迁移到源图像。
- **边缘范围设置**：
    - 设置为 `0` 或更小：使用整张图像的全局统计信息。
    - 设置为 `0` 到 `1` 之间（如 `0.2`）：使用图像最短边的一定百分比作为边缘宽度。
    - 设置为 `>= 1`：指定确切的像素宽度作为边缘。
