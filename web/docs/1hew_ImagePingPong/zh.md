# Image PingPong - 批量往返帧生成

**节点功能：** `Image PingPong` 基于输入批量帧按正向、反向交替生成序列：正向、反向、正向…，支持预反转与拼接处去重以获得更顺滑的过渡。

## 输入

| 参数名称 | 入端选择 | 数据类型 | 默认值 | 取值范围 | 描述 |
| -------- | -------- | -------- | ------ | -------- | ---- |
| `image` | - | IMAGE | - | - | 输入批量帧 `(B, H, W, C)`；沿批次轴进行重排。 |
| `pre_reverse` | - | BOOLEAN | `false` | - | 在生成序列前先将输入批量反转。 |
| `ops_count` | - | INT | `1` | `0-100000` | 生成的段数：例如 `2 → 正向，反向`；`3 → 正向，反向，正向`。`0` 表示无限（由 `frame_count` 截取）。 |
| `frame_count` | - | INT | `0` | `0-1000000` | 输出截取长度；`0` 表示不截取（除非 `ops_count=0`）。 |
| `remove_link_frame` | - | BOOLEAN | `true` | - | 对每个从第二段起的段，移除其首帧以避免与上一段末帧重复。 |

## 输出

| 输出名称 | 数据类型 | 描述 |
|---------|----------|------|
| `image` | IMAGE | 基于输入批量生成的往返序列。 |

## 功能说明

- 段交替：正向 `[0..B-1]`，反向 `[B-1..0]`，按段索引交替。
- 拼接去重：启用后，从第二段起移除该段首帧，避免边界重复，过渡更平滑。
- 预反转：在生成前先将输入批量反转，适合反向开场等需求。
- 灵活限制：`ops_count` 控制有限段数；当 `ops_count=0` 时按 `frame_count` 截取无限往返。

## 边界与极端情况

- `ops_count=0`、`frame_count=0` → 输出为空。
- `ops_count>0`、`frame_count=0` → 精确按段拼接（结合是否去重）。
- `ops_count=0`、`frame_count>0` → 无限往返并按 `frame_count` 截取。
- 两者均非零 → 先生成再截取；若生成不足则以生成量为准。

## 典型用法

- 构建无缝循环段：启用 `remove_link_frame`，避免相邻段重复帧引起卡顿。
- 反向起始：启用 `pre_reverse`，从反向开始生成往返序列。
- 用 `frame_count` 对齐下游片段长度或素材时长要求。

## 注意与建议

- 节点仅重排批次帧索引，不更改像素数据。
- 当 `B=1` 时，启用去重仍能保持稳定，不会产生重复帧。